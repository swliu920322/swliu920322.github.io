{"version":3,"sources":["webpack:///./src/views/dashboard/realtime-video/realtime-video.vue","webpack:///./src/components/dashboard/realtime-video/video-toggle.vue","webpack:///./src/components/dashboard/realtime-video/video-toggle.vue?bdde","webpack:///./src/components/dashboard/realtime-video/video-toggle.vue?7bd5","webpack:///./src/components/dashboard/realtime-video/time-loop.vue","webpack:///./src/components/dashboard/realtime-video/time-loop.vue?4f6c","webpack:///./src/components/dashboard/realtime-video/time-loop.vue?72a7","webpack:///./src/components/dashboard/realtime-video/video-display.vue","webpack:///./src/components/dashboard/realtime-video/video-display.vue?f97d","webpack:///./src/components/dashboard/realtime-video/video-display.vue?5e64","webpack:///./src/views/dashboard/realtime-video/realtime-video.simulate.ts","webpack:///./src/views/dashboard/realtime-video/realtime-video.vue?e425","webpack:///./src/views/dashboard/realtime-video/realtime-video.vue?7422","webpack:///./node_modules/core-js/internals/array-fill.js","webpack:///./node_modules/core-js/modules/es.array.splice.js","webpack:///./src/components/dashboard/realtime-video/video-display.vue?1038","webpack:///./src/views/dashboard/realtime-video/realtime-video.vue?7078","webpack:///./src/components/dashboard/realtime-video/time-loop.vue?78d8","webpack:///./node_modules/core-js/modules/es.array.fill.js","webpack:///./src/components/dashboard/realtime-video/video-toggle.vue?8b25"],"names":["class","style","ref","type","data","monitorData","placeholder","loop","changePage","videoData","src","alt","gotoPage","name","emits","setup","props","context","num","emit","render","__scopeId","changeTimer","current","progress","times","Array","default","reverse","index","value","frameId","startTime","accu","timer","lastValue","window","requestAnimationFrame","cancelAnimate","cancelAnimationFrame","length","undefined","activeClass","tag","newArr","curIndex","item","auto","setItemRef","key","id","components","VideoTest","lastSize","list","spliceArr","size","singleWeight","includes","level","calWeight","arr","reduce","all","cur","addCache","forEach","last","weight","push","sort","a","b","splice","slice","filter","i","l","end","start","el","getVideoData","reasons","Math","random","fill","map","reason","coal","place","FullChange","DataSelect","TimeLoop","VideoToggle","SiteSearch","VideoDisplay","searchRef","videoRef","addListener","msg","setValue","toObject","toAbsoluteIndex","toLength","module","exports","O","this","argumentsLength","arguments","endPos","$","toInteger","arraySpeciesCreate","createProperty","arrayMethodHasSpeciesSupport","HAS_SPECIES_SUPPORT","max","min","MAX_SAFE_INTEGER","MAXIMUM_ALLOWED_LENGTH_EXCEEDED","target","proto","forced","deleteCount","insertCount","actualDeleteCount","A","k","from","to","len","actualStart","TypeError","addToUnscopables"],"mappings":"sNACOA,MAAM,kD,GAKAA,MAAM,wB,GACRA,MAAM,Y,EAQX,eAAO,oB,GAGHA,MAAM,wB,GACDA,MAAM,0BAA0BC,MAAA,iB,uQAlB7C,eAwBM,MAxBN,EAwBM,CAvBJ,eAGE,GAFAD,MAAM,gCACNC,MAAA,yBAEF,eAUU,UAVV,EAUU,CATR,eAOM,MAPN,EAOM,CANJ,eAA0D,GAA9CC,IAAI,YAAYD,MAAA,yB,UAC5B,eAIE,GAHCE,KAAM,EACNC,KAAM,EAAAC,YACPC,YAAY,W,mBAGhB,IAEF,eAA6D,GAAnDN,MAAM,8BAA+B,OAAM,EAAAO,M,mBACrD,eAKO,OALP,EAKO,CAJL,eAEU,UAFV,EAEU,CADR,eAAwC,GAA1B,aAAY,EAAAC,YAAU,2BAEtC,eAA0E,GAA5DN,IAAI,WAAWF,MAAM,cAAeS,UAAW,EAAAA,W,wBAE/D,eAAc,Q,8GCvBPT,MAAM,2C,EACb,eAIE,OAHAA,MAAM,mBACNU,IAAA,IACAC,IAAI,M,YAEDX,MAAM,0D,GACLA,MAAM,wC,wEAPd,eAYU,UAZV,EAYU,CAXR,EAKA,eAKM,MALN,EAKM,CAJJ,eAGK,KAHL,EAGK,CAFH,eAAwD,MAApDA,MAAM,sBAAuB,QAAK,+BAAE,EAAAY,UAAQ,OAChD,eAA0D,MAAtDZ,MAAM,yBAA0B,QAAK,+BAAE,EAAAY,SAAQ,gBCP5C,iBAAgB,CAC7BC,KAAM,eACNC,MAAO,CACLN,WAAY,MAEdO,MAL6B,SAKvBC,EAAOC,GACX,MAAO,CACLL,SADK,SACIM,GACPD,EAAQE,KAAK,aAAcD,Q,UCNnC,EAAOE,OAAS,EAChB,EAAOC,UAAY,kBAEJ,Q,6ECLHrB,MAAM,kB,EACZ,eAAuC,QAAjCA,MAAM,mBAAkB,MAAE,G,EAElC,eAA0C,QAApCA,MAAM,mBAAkB,SAAK,G,GAC9BA,MAAM,uB,wEANb,eAYM,OAZDA,MAAM,oCAAqC,QAAK,8BAAE,EAAAsB,aAAA,EAAAA,YAAA,sB,CACrD,eAGM,YAFJ,eAAiD,OAAjD,EAAiD,eAAjB,EAAAC,SAAO,GACvC,IAEF,EACA,eAKM,MALN,EAKM,CAJJ,eAGE,OAFAvB,MAAM,oBACLC,MAAK,yBAA+B,EAAAuB,SAAQ,O,eCPtC,iBAAgB,CAC7BX,KAAM,YACNG,MAAO,CACLS,MAAO,CACLtB,KAAMuB,MACNC,QAAS,iBAAM,CAAC,EAAG,EAAG,EAAG,GAAI,GAAI,GAAI,IAAIC,aAG7Cd,MAAO,CAAEP,KAAM,MACfQ,MAT6B,SASvBC,EAAOC,GAEX,IAAMY,EAAQ,eAAI,GAEZN,EAAU,gBAAiB,kBAAMP,EAAMS,MAAMI,EAAMC,UAEnDN,EAAW,eAAI,GAEfO,EAAU,eAAY,GAEtBC,EAAY,iBAClB,SAASC,EAAKC,GACPF,EAAUF,QACbE,EAAUF,MAAQI,GAEpB,IAAMC,EAAYX,EAASM,MAC3BN,EAASM,OACJI,EAAQF,EAAUF,QAA0B,GAAhBP,EAAQO,OAAe,IAAQ,GAC5DK,EAAYX,EAASM,OACvBb,EAAQE,KAAK,QAEfY,EAAQD,MAAQM,OAAOC,sBAAsBJ,GAO/C,SAASK,IACPF,OAAOG,qBAAqBR,EAAQD,OAGtC,SAASR,IACPO,EAAMC,QAAUD,EAAMC,MAAQd,EAAMS,MAAMe,OAC1CF,IACAN,EAAUF,WAAQW,EAClBV,EAAQD,MAAQM,OAAOC,sBAAsBJ,GAG/C,OAfA,gBAAU,WACRF,EAAQD,MAAQM,OAAOC,sBAAsBJ,MAcxC,CACLV,UACAD,cACAE,e,UCjDN,EAAOJ,OAAS,EAChB,EAAOC,UAAY,kBAEJ,Q,yHCPb,eASmB,QATDrB,MAAK,CAAC,UAAkB,EAAA0C,aAAa7B,KAAK,QAAQ8B,IAAI,O,YAGpE,iBAAyC,E,mBAF3C,eAOE,2BALwB,EAAAC,OAAO,EAAAC,WAAQ,SAA/BC,EAAMjB,G,wBAFhB,eAOE,GANAkB,KAAA,GAEC7C,IAAK,EAAA8C,WACLC,IAAKH,EAAKI,GACVlD,MAAK,eAAU6B,EAAQ,GACvBiB,KAAMA,G,iJCYE,iBAAgB,CAC7BjC,KAAM,gBACNsC,WAAY,CACVC,UAAA,QAEFpC,MAAO,CACLP,UAAW,CACTN,KAAMuB,MACNC,QAAS,iBAAM,MAGnBZ,MAX6B,SAWvBC,GACJ,IAAMZ,EAAO,eAAgB,CAC3BwC,OAAQ,CAAC,IACTS,SAAU,EACVR,SAAU,IAENS,EAAO,eAAW,IAExB,SAASC,EAAUC,GACjB,SAASC,EAAaX,GACpB,MAAO,CAAC,EAAG,GAAGY,SAASZ,EAAKa,OAAS,EAAI,EAG3C,SAASC,EAAUC,GACjB,OAAOA,EAAIC,QAAO,SAACC,EAAKC,GAAN,OAAcD,EAAMN,EAAaO,KAAM,GAG3D,IAAMC,EAAqB,GAE3BjD,EAAMP,UAAUyD,SAAQ,SAAApC,GACtB,IAAMqC,EAAO/D,EAAKwC,OAAOxC,EAAKwC,OAAOJ,OAAS,GACxC4B,EAASR,EAAUO,GAEzB,GAAIC,EAASZ,EAAM,CACjB,IAAMO,EAAMN,EAAa3B,GAASsC,EAC9BL,GAAOP,GACTW,EAAKE,KAAKvC,GACNiC,IAAQP,GACVW,EAAKG,MAAK,SAACC,EAAGC,GAAJ,OAAUD,EAAEZ,MAAQa,EAAEb,UAGlCM,EAASI,KAAKvC,OAEX,CAEL,IAAM,EAAS8B,EAAUK,EAASQ,OAAO,EAAG,IACxC,EAASjB,EACXpD,EAAKwC,OAAOyB,KAAK,CAACvC,IAElBmC,EAASI,KAAKvC,OAKpB1B,EAAKiD,SAAW,CAACG,EAAM,GAAI,GAAI,EAAG,GAChCpD,EAAKwC,OAAO8B,OAAO,GAAG,GAAGC,QAAO,SAAAC,GAAC,OAAIA,EAAEjB,MAAQ,KAAGnB,QAKtD,SAAShC,EAAWU,GAClB,IAAM2D,EAAIzE,EAAKyC,SAAW3B,EAC1Bd,EAAKyC,UAAYgC,EAAI,EAAIzE,EAAKwC,OAAOJ,OAASqC,EAAIA,GAAKzE,EAAKwC,OAAOJ,OACnEc,EAAKxB,MAAMoC,SAAQ,SAAAU,GAChB,OAADA,QAAC,IAADA,KAAGE,SAELxB,EAAKxB,MAAQ,GACb,gBAAS,WACPwB,EAAKxB,MAAMoC,SAAQ,SAAAU,GAChB,OAADA,QAAC,IAADA,KAAGG,cAST,OAnBAxB,EAAU,IAeV,gBAAY,WACVD,EAAKxB,MAAMoC,SAAQ,SAAAU,GAAC,cAAIA,QAAJ,IAAIA,OAAJ,EAAIA,EAAGE,YAG7B,+BACEpC,YAAa,gBAAS,WACpB,OAAItC,EAAKyC,WAAazC,EAAKwC,OAAOJ,OAAS,EAClC,UAAYpC,EAAKiD,SAEnB,UAAYjD,EAAKwC,OAAOxC,EAAKyC,UAAUL,UAEhDhC,cACG,eAAOJ,IARZ,IASE4C,WATF,SASagC,GACT1B,EAAKxB,MAAMuC,KAAKW,S,UCxGxB,EAAO5D,OAAS,EAChB,EAAOC,UAAY,kBAEJ,Q,gCCCf,SAAS4D,IACP,IAAMC,EAAU,CAAC,SAAU,YAC3B,OAAO,IAAIxD,MAA+B,MAAN,GAAhByD,KAAKC,WAAqBC,KAAK,IAAIC,KAAI,SAACV,EAAG/C,GAC7D,MAAO,CACLqB,GAAIrB,EAAQ,EACZ8B,MAA+B,KAArB,EAAIwB,KAAKC,UACnBG,OAAQL,KAAWC,KAAKC,SAAWF,EAAQ1C,SAC3CV,SAA0B,IAAhBqD,KAAKC,UACfI,KAAM,OACNC,MAAO,gBAKE,Q,oCCXA,iBAAgB,CAC7B5E,KAAM,iBACNsC,WAAY,CACVuC,WAAA,OACAC,WAAA,OACAC,SAAA,EACAC,YAAA,EACAC,WAAA,OACAC,aAAA,GAEFhF,MAV6B,WAW3B,IAAMiF,EAAY,iBACZC,EAAW,iBAIjB,OAHA,OAAYC,aAAY,SAACC,GAAe,MACtC,UAAAH,EAAUlE,aAAV,SAAiBsE,SAASD,MAErB,CACLF,WACA5F,YAAA,OACAI,UAAW,IACXF,KAJK,WAID,MACF,UAAA0F,EAASnE,aAAT,SAAgBtB,WAAW,IAE7BA,WAPK,SAOMU,GAAW,MACpB,UAAA+E,EAASnE,aAAT,SAAgBtB,WAAWU,IAE7B8E,gB,UCjCN,EAAO5E,OAASA,EAChB,EAAOC,UAAY,kBAEJ,gB,6DCPf,IAAIgF,EAAW,EAAQ,QACnBC,EAAkB,EAAQ,QAC1BC,EAAW,EAAQ,QAIvBC,EAAOC,QAAU,SAAc3E,GAC7B,IAAI4E,EAAIL,EAASM,MACbnE,EAAS+D,EAASG,EAAElE,QACpBoE,EAAkBC,UAAUrE,OAC5BX,EAAQyE,EAAgBM,EAAkB,EAAIC,UAAU,QAAKpE,EAAWD,GACxEsC,EAAM8B,EAAkB,EAAIC,UAAU,QAAKpE,EAC3CqE,OAAiBrE,IAARqC,EAAoBtC,EAAS8D,EAAgBxB,EAAKtC,GAC/D,MAAOsE,EAASjF,EAAO6E,EAAE7E,KAAWC,EACpC,OAAO4E,I,oFCdT,IAAIK,EAAI,EAAQ,QACZT,EAAkB,EAAQ,QAC1BU,EAAY,EAAQ,QACpBT,EAAW,EAAQ,QACnBF,EAAW,EAAQ,QACnBY,EAAqB,EAAQ,QAC7BC,EAAiB,EAAQ,QACzBC,EAA+B,EAAQ,QAEvCC,EAAsBD,EAA6B,UAEnDE,EAAMlC,KAAKkC,IACXC,EAAMnC,KAAKmC,IACXC,EAAmB,iBACnBC,EAAkC,kCAKtCT,EAAE,CAAEU,OAAQ,QAASC,OAAO,EAAMC,QAASP,GAAuB,CAChE3C,OAAQ,SAAgBM,EAAO6C,GAC7B,IAIIC,EAAaC,EAAmBC,EAAGC,EAAGC,EAAMC,EAJ5CxB,EAAIL,EAASM,MACbwB,EAAM5B,EAASG,EAAElE,QACjB4F,EAAc9B,EAAgBvB,EAAOoD,GACrCvB,EAAkBC,UAAUrE,OAWhC,GATwB,IAApBoE,EACFiB,EAAcC,EAAoB,EACL,IAApBlB,GACTiB,EAAc,EACdC,EAAoBK,EAAMC,IAE1BP,EAAcjB,EAAkB,EAChCkB,EAAoBR,EAAID,EAAIL,EAAUY,GAAc,GAAIO,EAAMC,IAE5DD,EAAMN,EAAcC,EAAoBP,EAC1C,MAAMc,UAAUb,GAGlB,IADAO,EAAId,EAAmBP,EAAGoB,GACrBE,EAAI,EAAGA,EAAIF,EAAmBE,IACjCC,EAAOG,EAAcJ,EACjBC,KAAQvB,GAAGQ,EAAea,EAAGC,EAAGtB,EAAEuB,IAGxC,GADAF,EAAEvF,OAASsF,EACPD,EAAcC,EAAmB,CACnC,IAAKE,EAAII,EAAaJ,EAAIG,EAAML,EAAmBE,IACjDC,EAAOD,EAAIF,EACXI,EAAKF,EAAIH,EACLI,KAAQvB,EAAGA,EAAEwB,GAAMxB,EAAEuB,UACbvB,EAAEwB,GAEhB,IAAKF,EAAIG,EAAKH,EAAIG,EAAML,EAAoBD,EAAaG,WAAYtB,EAAEsB,EAAI,QACtE,GAAIH,EAAcC,EACvB,IAAKE,EAAIG,EAAML,EAAmBE,EAAII,EAAaJ,IACjDC,EAAOD,EAAIF,EAAoB,EAC/BI,EAAKF,EAAIH,EAAc,EACnBI,KAAQvB,EAAGA,EAAEwB,GAAMxB,EAAEuB,UACbvB,EAAEwB,GAGlB,IAAKF,EAAI,EAAGA,EAAIH,EAAaG,IAC3BtB,EAAEsB,EAAII,GAAevB,UAAUmB,EAAI,GAGrC,OADAtB,EAAElE,OAAS2F,EAAML,EAAoBD,EAC9BE,M,kCCjEX,W,kCCAA,W,kCCAA,W,qBCAA,IAAIhB,EAAI,EAAQ,QACZ1B,EAAO,EAAQ,QACfiD,EAAmB,EAAQ,QAI/BvB,EAAE,CAAEU,OAAQ,QAASC,OAAO,GAAQ,CAClCrC,KAAMA,IAIRiD,EAAiB,S,yDCXjB","file":"js/chunk-40db75da.25f95499.js","sourcesContent":["<template>\n  <div class=\"w100 h100 bk-img flex-column position-relative\">\n    <SiteSearch\n      class=\"position-absolute site-search\"\n      style=\"margin-left: 3rem;\"\n    />\n    <section class=\"flex-row just-center\">\n      <div class=\"flex-row\">\n        <DataSelect ref=\"searchRef\" style=\"margin-right: 3rem;\" />\n        <DataSelect\n          :type=\"2\"\n          :data=\"monitorData\"\n          placeholder=\"请选择监控位置\"\n        />\n      </div>\n      <div />\n    </section>\n    <TimeLoop class=\"position-absolute time-loop\" @loop=\"loop\" />\n    <main class=\"flex-1 flex-row mt20\">\n      <section class=\"flex-column just-center\" style=\"width: 19rem;\">\n        <VideoToggle @changePage=\"changePage\" />\n      </section>\n      <VideoDisplay ref=\"videoRef\" class=\"flex-1 h100\" :videoData=\"videoData\" />\n    </main>\n    <FullChange />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, ref } from \"vue\";\nimport SiteSearch from \"@/components/dashboard/common/site-search.vue\";\nimport VideoToggle from \"@/components/dashboard/realtime-video/video-toggle.vue\";\nimport TimeLoop from \"@/components/dashboard/realtime-video/time-loop.vue\";\nimport VideoDisplay from \"@/components/dashboard/realtime-video/video-display.vue\";\nimport { communicate } from \"@/utils\";\nimport getVideoData from \"./realtime-video.simulate\";\nimport DataSelect from \"@/components/dashboard/common/data-select.vue\";\nimport { monitorData } from \"@/components/dashboard/common/data-select.mock\";\nimport FullChange from \"@/components/dashboard/common/full-change.vue\";\n\nexport default defineComponent({\n  name: \"realtime-video\",\n  components: {\n    FullChange,\n    DataSelect,\n    TimeLoop,\n    VideoToggle,\n    SiteSearch,\n    VideoDisplay\n  },\n  setup() {\n    const searchRef = ref<any>();\n    const videoRef = ref<{ changePage: Function }>();\n    communicate.addListener((msg: string) => {\n      searchRef.value?.setValue(msg);\n    });\n    return {\n      videoRef,\n      monitorData,\n      videoData: getVideoData(),\n      loop() {\n        videoRef.value?.changePage(1);\n      },\n      changePage(num: number) {\n        videoRef.value?.changePage(num);\n      },\n      searchRef\n    };\n  }\n});\n</script>\n\n<style scoped lang=\"less\">\n.bk-img {\n  padding: 3rem 3rem 3rem 0;\n\n  .time-loop {\n    bottom: 3rem;\n    left: 3rem;\n  }\n}\n</style>\n","<template>\n  <section class=\"video-toggle position-relative flex-row\">\n    <img\n      class=\"video-toggle__bk\"\n      src=\"../../../assets/svg/dashboard/realtime-video/circle.svg\"\n      alt=\"半圆\"\n    />\n    <div class=\"video-toggle__button flex-row align-center just-center\">\n      <ul class=\"mb0 button-contain position-relative\">\n        <li class=\"button-contain__top\" @click=\"gotoPage(-1)\" />\n        <li class=\"button-contain__bottom\" @click=\"gotoPage(1)\" />\n      </ul>\n    </div>\n  </section>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  name: \"video-toggle\",\n  emits: {\n    changePage: null\n  },\n  setup(props, context) {\n    return {\n      gotoPage(num: number) {\n        context.emit(\"changePage\", num);\n      }\n    };\n  }\n});\n</script>\n\n<style lang=\"less\" scoped>\n.video-toggle {\n  z-index: 10;\n  width: calc(100% - 3rem);\n  overflow: hidden;\n\n  &__bk {\n    max-width: 200%;\n    transform: translateX(-50%);\n  }\n\n  &__button {\n    position: absolute;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n\n    .button-contain {\n      width: 3rem;\n      height: 13.4rem;\n      background-image: url(\"~@/assets/svg/dashboard/realtime-video/top-bottom-arrow.svg\");\n      background-position: center;\n      background-size: contain;\n\n      &__top,\n      &__bottom {\n        position: absolute;\n        right: 0;\n        left: 0;\n        height: 3rem;\n        cursor: pointer;\n      }\n\n      &__top {\n        top: 0;\n      }\n\n      &__bottom {\n        bottom: 0;\n      }\n    }\n  }\n}\n</style>\n","\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  name: \"video-toggle\",\n  emits: {\n    changePage: null\n  },\n  setup(props, context) {\n    return {\n      gotoPage(num: number) {\n        context.emit(\"changePage\", num);\n      }\n    };\n  }\n});\n","import { render } from \"./video-toggle.vue?vue&type=template&id=9dda2d42&scoped=true\"\nimport script from \"./video-toggle.vue?vue&type=script&lang=ts\"\nexport * from \"./video-toggle.vue?vue&type=script&lang=ts\"\n\nimport \"./video-toggle.vue?vue&type=style&index=0&id=9dda2d42&lang=less&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-9dda2d42\"\n\nexport default script","<template>\n  <div class=\"flex-column time-loop cur-pointer\" @click=\"changeTimer\">\n    <div>\n      <span class=\"time-loop__num\">{{ current }}</span>\n      <span class=\"time-loop__unit\">分钟</span>\n    </div>\n    <span class=\"time-loop__desc\">后切换视频</span>\n    <div class=\"time-loop__progress\">\n      <div\n        class=\"time-loop__active\"\n        :style=\"{ transform: 'translateX(' + progress + '%)' }\"\n      />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, onMounted, PropType, ref } from \"vue\";\n\nexport default defineComponent({\n  name: \"time-loop\",\n  props: {\n    times: {\n      type: Array as PropType<number[]>,\n      default: () => [1, 3, 5, 10, 15, 20, 30].reverse()\n    }\n  },\n  emits: { loop: null },\n  setup(props, context) {\n    // 当前的索引\n    const index = ref(0);\n    // 当前的时间间隔\n    const current = computed<number>(() => props.times[index.value]);\n    // 进度1~100\n    const progress = ref(0);\n    // 动画帧id\n    const frameId = ref<number>(1);\n    // 开始的时间,用来切换后重算动画发生时间\n    const startTime = ref<number>();\n    function accu(timer: number) {\n      if (!startTime.value) {\n        startTime.value = timer;\n      }\n      const lastValue = progress.value;\n      progress.value =\n        (((timer - startTime.value) / (current.value * 60)) % 1000) / 10;\n      if (lastValue > progress.value) {\n        context.emit(\"loop\");\n      }\n      frameId.value = window.requestAnimationFrame(accu);\n    }\n\n    onMounted(() => {\n      frameId.value = window.requestAnimationFrame(accu);\n    });\n\n    function cancelAnimate() {\n      window.cancelAnimationFrame(frameId.value);\n    }\n\n    function changeTimer() {\n      index.value = ++index.value % props.times.length;\n      cancelAnimate();\n      startTime.value = undefined;\n      frameId.value = window.requestAnimationFrame(accu);\n    }\n\n    return {\n      current,\n      changeTimer,\n      progress\n    };\n  }\n});\n</script>\n\n<style scoped lang=\"less\">\n.time-loop {\n  font-size: 2rem;\n  color: #62ffcb;\n\n  &__num {\n    font-size: 5rem;\n  }\n\n  &__unit {\n    float: right;\n    margin-top: 3rem;\n  }\n\n  &__desc {\n    letter-spacing: 0.2rem;\n    opacity: 0.35;\n  }\n\n  &__progress,\n  &__active {\n    width: 13rem;\n    height: 0.6rem;\n  }\n\n  &__progress {\n    position: relative;\n    margin-top: 10px;\n    overflow: hidden;\n    background-color: #62ffcb20;\n  }\n\n  &__active {\n    position: absolute;\n    top: 0;\n    right: 13rem;\n    bottom: 0;\n    background-color: #62ffcb;\n  }\n}\n</style>\n","\nimport { computed, defineComponent, onMounted, PropType, ref } from \"vue\";\n\nexport default defineComponent({\n  name: \"time-loop\",\n  props: {\n    times: {\n      type: Array as PropType<number[]>,\n      default: () => [1, 3, 5, 10, 15, 20, 30].reverse()\n    }\n  },\n  emits: { loop: null },\n  setup(props, context) {\n    // 当前的索引\n    const index = ref(0);\n    // 当前的时间间隔\n    const current = computed<number>(() => props.times[index.value]);\n    // 进度1~100\n    const progress = ref(0);\n    // 动画帧id\n    const frameId = ref<number>(1);\n    // 开始的时间,用来切换后重算动画发生时间\n    const startTime = ref<number>();\n    function accu(timer: number) {\n      if (!startTime.value) {\n        startTime.value = timer;\n      }\n      const lastValue = progress.value;\n      progress.value =\n        (((timer - startTime.value) / (current.value * 60)) % 1000) / 10;\n      if (lastValue > progress.value) {\n        context.emit(\"loop\");\n      }\n      frameId.value = window.requestAnimationFrame(accu);\n    }\n\n    onMounted(() => {\n      frameId.value = window.requestAnimationFrame(accu);\n    });\n\n    function cancelAnimate() {\n      window.cancelAnimationFrame(frameId.value);\n    }\n\n    function changeTimer() {\n      index.value = ++index.value % props.times.length;\n      cancelAnimate();\n      startTime.value = undefined;\n      frameId.value = window.requestAnimationFrame(accu);\n    }\n\n    return {\n      current,\n      changeTimer,\n      progress\n    };\n  }\n});\n","import { render } from \"./time-loop.vue?vue&type=template&id=00bc5d7e&scoped=true\"\nimport script from \"./time-loop.vue?vue&type=script&lang=ts\"\nexport * from \"./time-loop.vue?vue&type=script&lang=ts\"\n\nimport \"./time-loop.vue?vue&type=style&index=0&id=00bc5d7e&scoped=true&lang=less\"\nscript.render = render\nscript.__scopeId = \"data-v-00bc5d7e\"\n\nexport default script","<template>\n  <transition-group class=\"wrapper\" :class=\"activeClass\" name=\"video\" tag=\"div\">\n    <VideoTest\n      auto\n      v-for=\"(item, index) in newArr[curIndex]\"\n      :ref=\"setItemRef\"\n      :key=\"item.id\"\n      :class=\"`item-${index + 1}`\"\n      :item=\"item\"\n    />\n  </transition-group>\n</template>\n\n<script lang=\"ts\">\nimport {\n  computed,\n  defineComponent,\n  PropType,\n  reactive,\n  ref,\n  toRefs,\n  nextTick,\n  onUnmounted\n} from \"vue\";\nimport VideoTest from \"./video-test.vue\";\nimport { IVideo } from \"@/views/dashboard/realtime-video/realtime-video.simulate\";\n\ninterface IView {\n  curIndex: number;\n  lastSize: number;\n  newArr: IVideo[][];\n}\n\nexport default defineComponent({\n  name: \"video-display\",\n  components: {\n    VideoTest\n  },\n  props: {\n    videoData: {\n      type: Array as PropType<IVideo[]>,\n      default: () => []\n    }\n  },\n  setup(props) {\n    const data = reactive<IView>({\n      newArr: [[]],\n      lastSize: 0,\n      curIndex: 0\n    });\n    const list = ref<any[]>([]);\n    // 切分数组，每个不得超过16\n    function spliceArr(size: number) {\n      function singleWeight(item: IVideo) {\n        return [1, 2].includes(item.level) ? 4 : 1;\n      }\n\n      function calWeight(arr: IVideo[]) {\n        return arr.reduce((all, cur) => all + singleWeight(cur), 0);\n      }\n\n      const addCache: IVideo[] = [];\n\n      props.videoData.forEach(value => {\n        const last = data.newArr[data.newArr.length - 1];\n        const weight = calWeight(last);\n        // 如果还没满size，先加，如果大出size，目前的放缓存，进行下一个\n        if (weight < size) {\n          const all = singleWeight(value) + weight;\n          if (all <= size) {\n            last.push(value);\n            if (all === size) {\n              last.sort((a, b) => a.level - b.level);\n            }\n          } else {\n            addCache.push(value);\n          }\n        } else {\n          // 先从add缓存中取,如果都塞满了，当前进缓存\n          const weight = calWeight(addCache.splice(0, 4));\n          if (weight < size) {\n            data.newArr.push([value]);\n          } else {\n            addCache.push(value);\n          }\n        }\n      });\n      // 对最后取该有的尺寸\n      data.lastSize = [size, 13, 10, 7, 4][\n        data.newArr.slice(-1)[0].filter(i => i.level < 3).length\n      ];\n    }\n\n    spliceArr(16);\n    function changePage(num: number) {\n      const l = data.curIndex + num;\n      data.curIndex = (l < 0 ? data.newArr.length + l : l) % data.newArr.length;\n      list.value.forEach(i => {\n        i?.end();\n      });\n      list.value = [];\n      nextTick(() => {\n        list.value.forEach(i => {\n          i?.start();\n        });\n      });\n    }\n\n    onUnmounted(() => {\n      list.value.forEach(i => i?.end());\n    });\n\n    return {\n      activeClass: computed(() => {\n        if (data.curIndex === data.newArr.length - 1) {\n          return \"wrapper\" + data.lastSize;\n        }\n        return \"wrapper\" + data.newArr[data.curIndex].length;\n      }),\n      changePage,\n      ...toRefs(data),\n      setItemRef(el: any) {\n        list.value.push(el);\n      }\n    };\n  }\n});\n</script>\n\n<style lang=\"less\" scoped>\n.wrapper {\n  display: grid;\n  grid-template-columns: repeat(4, 1fr);\n  grid-template-rows: repeat(4, 1fr);\n  column-gap: 2rem;\n  row-gap: 0.5rem;\n}\n\n.wrapper16 {\n  grid-template-areas:\n    \"a b c d\"\n    \"e f g h\"\n    \"i j k l\"\n    \"m n o p\";\n}\n\n.wrapper13 {\n  grid-template-areas:\n    \"a a b c\"\n    \"a a d e\"\n    \"f g h i \"\n    \"j k l m \";\n}\n\n.wrapper10 {\n  grid-template-areas:\n    \"a a b b\"\n    \"a a b b\"\n    \"c d e f \"\n    \"g h i j \";\n}\n\n.wrapper7 {\n  grid-template-areas:\n    \"a a b b\"\n    \"a a b b\"\n    \"c c d e \"\n    \"c c f g \";\n}\n\n.wrapper4 {\n  grid-template-areas:\n    \"a a b b\"\n    \"a a b b\"\n    \"c c d d\"\n    \"c c d d\";\n}\n\n.item-1 {\n  grid-area: a;\n}\n\n.item-2 {\n  grid-area: b;\n}\n\n.item-3 {\n  grid-area: c;\n}\n\n.item-4 {\n  grid-area: d;\n}\n\n.item-5 {\n  grid-area: e;\n}\n\n.item-6 {\n  grid-area: f;\n}\n\n.item-7 {\n  grid-area: g;\n}\n\n.item-8 {\n  grid-area: h;\n}\n\n.item-9 {\n  grid-area: i;\n}\n\n.item-10 {\n  grid-area: j;\n}\n\n.item-11 {\n  grid-area: k;\n}\n\n.item-12 {\n  grid-area: l;\n}\n\n.item-13 {\n  grid-area: m;\n}\n\n.item-14 {\n  grid-area: n;\n}\n\n.item-15 {\n  grid-area: o;\n}\n\n.item-16 {\n  grid-area: p;\n}\n\n.video-leave-active,\n.video-enter-active {\n  transition: all 1s linear;\n}\n\n.video-enter-from,\n.video-leave-to {\n  opacity: 0;\n  transform: rotateY(180deg);\n}\n</style>\n","\nimport {\n  computed,\n  defineComponent,\n  PropType,\n  reactive,\n  ref,\n  toRefs,\n  nextTick,\n  onUnmounted\n} from \"vue\";\nimport VideoTest from \"./video-test.vue\";\nimport { IVideo } from \"@/views/dashboard/realtime-video/realtime-video.simulate\";\n\ninterface IView {\n  curIndex: number;\n  lastSize: number;\n  newArr: IVideo[][];\n}\n\nexport default defineComponent({\n  name: \"video-display\",\n  components: {\n    VideoTest\n  },\n  props: {\n    videoData: {\n      type: Array as PropType<IVideo[]>,\n      default: () => []\n    }\n  },\n  setup(props) {\n    const data = reactive<IView>({\n      newArr: [[]],\n      lastSize: 0,\n      curIndex: 0\n    });\n    const list = ref<any[]>([]);\n    // 切分数组，每个不得超过16\n    function spliceArr(size: number) {\n      function singleWeight(item: IVideo) {\n        return [1, 2].includes(item.level) ? 4 : 1;\n      }\n\n      function calWeight(arr: IVideo[]) {\n        return arr.reduce((all, cur) => all + singleWeight(cur), 0);\n      }\n\n      const addCache: IVideo[] = [];\n\n      props.videoData.forEach(value => {\n        const last = data.newArr[data.newArr.length - 1];\n        const weight = calWeight(last);\n        // 如果还没满size，先加，如果大出size，目前的放缓存，进行下一个\n        if (weight < size) {\n          const all = singleWeight(value) + weight;\n          if (all <= size) {\n            last.push(value);\n            if (all === size) {\n              last.sort((a, b) => a.level - b.level);\n            }\n          } else {\n            addCache.push(value);\n          }\n        } else {\n          // 先从add缓存中取,如果都塞满了，当前进缓存\n          const weight = calWeight(addCache.splice(0, 4));\n          if (weight < size) {\n            data.newArr.push([value]);\n          } else {\n            addCache.push(value);\n          }\n        }\n      });\n      // 对最后取该有的尺寸\n      data.lastSize = [size, 13, 10, 7, 4][\n        data.newArr.slice(-1)[0].filter(i => i.level < 3).length\n      ];\n    }\n\n    spliceArr(16);\n    function changePage(num: number) {\n      const l = data.curIndex + num;\n      data.curIndex = (l < 0 ? data.newArr.length + l : l) % data.newArr.length;\n      list.value.forEach(i => {\n        i?.end();\n      });\n      list.value = [];\n      nextTick(() => {\n        list.value.forEach(i => {\n          i?.start();\n        });\n      });\n    }\n\n    onUnmounted(() => {\n      list.value.forEach(i => i?.end());\n    });\n\n    return {\n      activeClass: computed(() => {\n        if (data.curIndex === data.newArr.length - 1) {\n          return \"wrapper\" + data.lastSize;\n        }\n        return \"wrapper\" + data.newArr[data.curIndex].length;\n      }),\n      changePage,\n      ...toRefs(data),\n      setItemRef(el: any) {\n        list.value.push(el);\n      }\n    };\n  }\n});\n","import { render } from \"./video-display.vue?vue&type=template&id=363bab51&scoped=true\"\nimport script from \"./video-display.vue?vue&type=script&lang=ts\"\nexport * from \"./video-display.vue?vue&type=script&lang=ts\"\n\nimport \"./video-display.vue?vue&type=style&index=0&id=363bab51&lang=less&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-363bab51\"\n\nexport default script","export interface IVideo {\n  id: number;\n  level: number;\n  reason: string;\n  value: number;\n  coal: string;\n  place: string;\n}\n\nfunction getVideoData(): IVideo[] {\n  const reasons = [\"甲烷浓度超标\", \"过水断面水位超标\"];\n  return new Array(~~(Math.random() * 50) + 50).fill(\"\").map((i, index) => {\n    return {\n      id: index + 1,\n      level: ~~(8 * Math.random()) + 1,\n      reason: reasons[~~(Math.random() * reasons.length)],\n      value: ~~(Math.random() * 100),\n      coal: \"海湾煤矿\",\n      place: \"D24386工作面\"\n    };\n  });\n}\n\nexport default getVideoData;\n","\nimport { defineComponent, ref } from \"vue\";\nimport SiteSearch from \"@/components/dashboard/common/site-search.vue\";\nimport VideoToggle from \"@/components/dashboard/realtime-video/video-toggle.vue\";\nimport TimeLoop from \"@/components/dashboard/realtime-video/time-loop.vue\";\nimport VideoDisplay from \"@/components/dashboard/realtime-video/video-display.vue\";\nimport { communicate } from \"@/utils\";\nimport getVideoData from \"./realtime-video.simulate\";\nimport DataSelect from \"@/components/dashboard/common/data-select.vue\";\nimport { monitorData } from \"@/components/dashboard/common/data-select.mock\";\nimport FullChange from \"@/components/dashboard/common/full-change.vue\";\n\nexport default defineComponent({\n  name: \"realtime-video\",\n  components: {\n    FullChange,\n    DataSelect,\n    TimeLoop,\n    VideoToggle,\n    SiteSearch,\n    VideoDisplay\n  },\n  setup() {\n    const searchRef = ref<any>();\n    const videoRef = ref<{ changePage: Function }>();\n    communicate.addListener((msg: string) => {\n      searchRef.value?.setValue(msg);\n    });\n    return {\n      videoRef,\n      monitorData,\n      videoData: getVideoData(),\n      loop() {\n        videoRef.value?.changePage(1);\n      },\n      changePage(num: number) {\n        videoRef.value?.changePage(num);\n      },\n      searchRef\n    };\n  }\n});\n","import { render } from \"./realtime-video.vue?vue&type=template&id=f12ba538&scoped=true\"\nimport script from \"./realtime-video.vue?vue&type=script&lang=ts\"\nexport * from \"./realtime-video.vue?vue&type=script&lang=ts\"\n\nimport \"./realtime-video.vue?vue&type=style&index=0&id=f12ba538&scoped=true&lang=less\"\nscript.render = render\nscript.__scopeId = \"data-v-f12ba538\"\n\nexport default script","'use strict';\nvar toObject = require('../internals/to-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar toLength = require('../internals/to-length');\n\n// `Array.prototype.fill` method implementation\n// https://tc39.es/ecma262/#sec-array.prototype.fill\nmodule.exports = function fill(value /* , start = 0, end = @length */) {\n  var O = toObject(this);\n  var length = toLength(O.length);\n  var argumentsLength = arguments.length;\n  var index = toAbsoluteIndex(argumentsLength > 1 ? arguments[1] : undefined, length);\n  var end = argumentsLength > 2 ? arguments[2] : undefined;\n  var endPos = end === undefined ? length : toAbsoluteIndex(end, length);\n  while (endPos > index) O[index++] = value;\n  return O;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar toInteger = require('../internals/to-integer');\nvar toLength = require('../internals/to-length');\nvar toObject = require('../internals/to-object');\nvar arraySpeciesCreate = require('../internals/array-species-create');\nvar createProperty = require('../internals/create-property');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('splice');\n\nvar max = Math.max;\nvar min = Math.min;\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;\nvar MAXIMUM_ALLOWED_LENGTH_EXCEEDED = 'Maximum allowed length exceeded';\n\n// `Array.prototype.splice` method\n// https://tc39.es/ecma262/#sec-array.prototype.splice\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  splice: function splice(start, deleteCount /* , ...items */) {\n    var O = toObject(this);\n    var len = toLength(O.length);\n    var actualStart = toAbsoluteIndex(start, len);\n    var argumentsLength = arguments.length;\n    var insertCount, actualDeleteCount, A, k, from, to;\n    if (argumentsLength === 0) {\n      insertCount = actualDeleteCount = 0;\n    } else if (argumentsLength === 1) {\n      insertCount = 0;\n      actualDeleteCount = len - actualStart;\n    } else {\n      insertCount = argumentsLength - 2;\n      actualDeleteCount = min(max(toInteger(deleteCount), 0), len - actualStart);\n    }\n    if (len + insertCount - actualDeleteCount > MAX_SAFE_INTEGER) {\n      throw TypeError(MAXIMUM_ALLOWED_LENGTH_EXCEEDED);\n    }\n    A = arraySpeciesCreate(O, actualDeleteCount);\n    for (k = 0; k < actualDeleteCount; k++) {\n      from = actualStart + k;\n      if (from in O) createProperty(A, k, O[from]);\n    }\n    A.length = actualDeleteCount;\n    if (insertCount < actualDeleteCount) {\n      for (k = actualStart; k < len - actualDeleteCount; k++) {\n        from = k + actualDeleteCount;\n        to = k + insertCount;\n        if (from in O) O[to] = O[from];\n        else delete O[to];\n      }\n      for (k = len; k > len - actualDeleteCount + insertCount; k--) delete O[k - 1];\n    } else if (insertCount > actualDeleteCount) {\n      for (k = len - actualDeleteCount; k > actualStart; k--) {\n        from = k + actualDeleteCount - 1;\n        to = k + insertCount - 1;\n        if (from in O) O[to] = O[from];\n        else delete O[to];\n      }\n    }\n    for (k = 0; k < insertCount; k++) {\n      O[k + actualStart] = arguments[k + 2];\n    }\n    O.length = len - actualDeleteCount + insertCount;\n    return A;\n  }\n});\n","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./video-display.vue?vue&type=style&index=0&id=363bab51&lang=less&scoped=true\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./realtime-video.vue?vue&type=style&index=0&id=f12ba538&scoped=true&lang=less\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./time-loop.vue?vue&type=style&index=0&id=00bc5d7e&scoped=true&lang=less\"","var $ = require('../internals/export');\nvar fill = require('../internals/array-fill');\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// `Array.prototype.fill` method\n// https://tc39.es/ecma262/#sec-array.prototype.fill\n$({ target: 'Array', proto: true }, {\n  fill: fill\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('fill');\n","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./video-toggle.vue?vue&type=style&index=0&id=9dda2d42&lang=less&scoped=true\""],"sourceRoot":""}